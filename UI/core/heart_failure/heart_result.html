<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Kết Quả Dự Đoán Suy Tim | SmartClinic.AI</title>
        <link
            rel="icon"
            type="image/x-icon"
            href="../static/home/images/logoicon.webp"
        />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
        <script src="https://cdn.tailwindcss.com"></script>
        <!-- Auth Guard Script -->
        <script src="../auth/auth-guard.js"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            primary: "#3b82f6",
                            secondary: "#64748b",
                            success: "#10b981",
                            warning: "#f59e0b",
                            danger: "#ef4444",
                            info: "#06b6d4",
                        },
                    },
                },
            };
        </script>
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap");

            :root {
                --primary-color: #3b82f6;
                --secondary-color: #64748b;
                --success-color: #10b981;
                --warning-color: #f59e0b;
                --danger-color: #ef4444;
                --info-color: #06b6d4;
                --light-color: #f8fafc;
                --dark-color: #1e293b;
            }

            body {
                font-family: "Roboto", sans-serif;
                background-color: var(--light-color);
            }

            .result-card {
                border: none;
                border-radius: 16px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
                overflow: hidden;
                transition: all 0.3s ease;
            }

            .result-card:hover {
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
                transform: translateY(-5px);
            }

            .icon-wrapper {
                width: 100px;
                height: 100px;
                border-radius: 50%;
                background-color: rgba(59, 130, 246, 0.1);
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto 1.5rem;
                transition: all 0.3s ease;
            }

            .icon-wrapper.success {
                background-color: rgba(16, 185, 129, 0.1);
            }

            .icon-wrapper.warning {
                background-color: rgba(245, 158, 11, 0.1);
            }

            .icon-wrapper.danger {
                background-color: rgba(239, 68, 68, 0.1);
            }

            .progress-indicator {
                display: flex;
                justify-content: space-between;
                margin-bottom: 2rem;
            }

            .progress-step {
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 33.33%;
                position: relative;
            }

            .progress-step::after {
                content: "";
                position: absolute;
                top: 15px;
                right: -50%;
                width: 100%;
                height: 3px;
                background-color: #e2e8f0;
                z-index: 0;
            }

            .progress-step:last-child::after {
                display: none;
            }

            .progress-step.active .step-number {
                background-color: var(--primary-color);
                color: white;
            }

            .progress-step.completed .step-number {
                background-color: var(--success-color);
                color: white;
            }

            .step-number {
                width: 35px;
                height: 35px;
                border-radius: 50%;
                background-color: #e2e8f0;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                margin-bottom: 8px;
                position: relative;
                z-index: 1;
            }

            .step-label {
                font-size: 0.85rem;
                color: var(--secondary-color);
                text-align: center;
            }

            .progress-step.active .step-label {
                color: var(--dark-color);
                font-weight: 500;
            }

            .btn-primary {
                background-color: var(--primary-color);
                border: none;
                border-radius: 10px;
                padding: 12px 30px;
                font-weight: 500;
                transition: all 0.3s ease;
            }

            .btn-primary:hover {
                background-color: #2563eb;
                transform: translateY(-2px);
                box-shadow: 0 6px 15px rgba(59, 130, 246, 0.3);
            }

            .result-message {
                font-size: 1.25rem;
                line-height: 1.75rem;
                margin-bottom: 2rem;
            }

            .recommendation-card {
                border-radius: 12px;
                padding: 1.5rem;
                margin-bottom: 2rem;
                border-left: 5px solid;
            }

            .recommendation-card.positive {
                background-color: rgba(16, 185, 129, 0.1);
                border-left-color: var(--success-color);
            }

            .recommendation-card.negative {
                background-color: rgba(239, 68, 68, 0.1);
                border-left-color: var(--danger-color);
            }

            .recommendation-card h5 {
                display: flex;
                align-items: center;
                margin-bottom: 1rem;
            }

            .recommendation-card h5 i {
                margin-right: 0.75rem;
            }

            .next-steps {
                margin-top: 2rem;
            }

            .action-item {
                display: flex;
                align-items: start;
                margin-bottom: 1rem;
            }

            .action-icon {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background-color: rgba(59, 130, 246, 0.1);
                display: flex;
                align-items: center;
                justify-content: center;
                margin-right: 1rem;
                flex-shrink: 0;
            }

            .health-tips {
                margin-top: 3rem;
            }

            .tip-card {
                border-radius: 12px;
                padding: 1.5rem;
                height: 100%;
                transition: all 0.3s ease;
                border: 1px solid #e2e8f0;
            }

            .tip-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            }

            .tip-icon {
                width: 60px;
                height: 60px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                margin-bottom: 1rem;
            }
        </style>
    </head>

    <body>
        <!-- Nhúng topbar mới -->
        <!--#include file="../../..../static/utils/home/topbar.html" -->

        <main class="container py-5">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <!-- Progress steps -->
                    <div class="progress-indicator mb-5">
                        <div class="progress-step completed">
                            <div class="step-number">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="step-label">Thông tin cá nhân</div>
                        </div>
                        <div class="progress-step completed">
                            <div class="step-number">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="step-label">Chỉ số sức khỏe</div>
                        </div>
                        <div class="progress-step active">
                            <div class="step-number">3</div>
                            <div class="step-label">Kết quả</div>
                        </div>
                    </div>

                    <!-- Result Card -->
                    <div class="card result-card mb-4">
                        <div class="card-body p-5 text-center">
                            <div
                                id="resultIconWrapper"
                                class="icon-wrapper mb-4"
                            >
                                <i
                                    id="resultIcon"
                                    class="fas fa-heartbeat fa-3x text-primary"
                                ></i>
                            </div>
                            <h2 class="fw-bold mb-4">
                                Kết Quả Phân Tích Nguy Cơ Suy Tim
                            </h2>
                            <div
                                id="resultMessage"
                                class="result-message text-dark mb-5"
                            ></div>

                            <div
                                id="recommendation"
                                class="recommendation-card d-none"
                            >
                                <h5 class="fw-bold">
                                    <i
                                        id="recommendationIcon"
                                        class="fas fa-info-circle"
                                    ></i>
                                    <span id="recommendationTitle"
                                        >Kết luận</span
                                    >
                                </h5>
                                <p id="recommendationText" class="mb-0"></p>
                            </div>

                            <div
                                class="next-steps bg-white rounded-3 text-start"
                            >
                                <h4 class="fw-bold mb-4">Các bước tiếp theo</h4>
                                <div id="positiveResults" class="d-none">
                                    <div class="action-item">
                                        <div class="action-icon">
                                            <i
                                                class="fas fa-heart-pulse text-success"
                                            ></i>
                                        </div>
                                        <div>
                                            <h5 class="fw-bold mb-1">
                                                Duy trì chế độ sống lành mạnh
                                            </h5>
                                            <p class="text-secondary">
                                                Tiếp tục duy trì chế độ ăn uống
                                                cân bằng, tập thể dục thường
                                                xuyên và hạn chế đồ uống có cồn,
                                                thuốc lá.
                                            </p>
                                        </div>
                                    </div>
                                    <div class="action-item">
                                        <div class="action-icon">
                                            <i
                                                class="fas fa-calendar-check text-success"
                                            ></i>
                                        </div>
                                        <div>
                                            <h5 class="fw-bold mb-1">
                                                Khám sức khỏe định kỳ
                                            </h5>
                                            <p class="text-secondary">
                                                Duy trì lịch kiểm tra sức khỏe
                                                tim mạch định kỳ hàng năm để
                                                theo dõi.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div id="negativeResults" class="d-none">
                                    <div class="action-item">
                                        <div class="action-icon">
                                            <i
                                                class="fas fa-user-doctor text-danger"
                                            ></i>
                                        </div>
                                        <div>
                                            <h5 class="fw-bold mb-1">
                                                Tham khảo ý kiến chuyên gia tim
                                                mạch
                                            </h5>
                                            <p class="text-secondary">
                                                Hãy đặt lịch khám với bác sĩ tim
                                                mạch để được đánh giá chi tiết
                                                và tư vấn điều trị.
                                            </p>
                                        </div>
                                    </div>
                                    <div class="action-item">
                                        <div class="action-icon">
                                            <i
                                                class="fas fa-notes-medical text-danger"
                                            ></i>
                                        </div>
                                        <div>
                                            <h5 class="fw-bold mb-1">
                                                Xét nghiệm chuyên sâu
                                            </h5>
                                            <p class="text-secondary">
                                                Cần thực hiện các xét nghiệm
                                                chuyên sâu như siêu âm tim, điện
                                                tâm đồ gắng sức và xét nghiệm
                                                máu để kiểm tra chức năng tim.
                                            </p>
                                        </div>
                                    </div>
                                    <div class="action-item">
                                        <div class="action-icon">
                                            <i
                                                class="fas fa-heart text-danger"
                                            ></i>
                                        </div>
                                        <div>
                                            <h5 class="fw-bold mb-1">
                                                Điều chỉnh lối sống
                                            </h5>
                                            <p class="text-secondary">
                                                Giảm lượng muối trong chế độ ăn,
                                                tăng cường hoạt động thể chất
                                                phù hợp, quản lý cân nặng và
                                                kiểm soát căng thẳng.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div
                                class="mt-5 d-flex flex-column flex-sm-row justify-content-center gap-3"
                            >
                                <a
                                    href="heart_failure_form.html"
                                    class="btn btn-primary"
                                >
                                    <i class="fas fa-redo me-2"></i> Kiểm tra
                                    lại
                                </a>
                                <a href="#" class="btn btn-outline-primary">
                                    <i class="fas fa-print me-2"></i> Lưu kết
                                    quả
                                </a>
                                <a
                                    href="../chat/chatbot_markdown.html"
                                    class="btn btn-outline-primary"
                                >
                                    <i class="fas fa-comment-medical me-2"></i>
                                    Tư vấn với AI
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Disclaimer -->
                    <div
                        class="alert alert-info d-flex align-items-center rounded-3 p-3 mb-4"
                    >
                        <i class="fas fa-info-circle fs-4 me-3 text-info"></i>
                        <div>
                            <strong>Lưu ý quan trọng:</strong> Kết quả dự đoán
                            này chỉ mang tính tham khảo và không thay thế cho
                            chẩn đoán y khoa chính thức. Vui lòng tham khảo ý
                            kiến bác sĩ để được tư vấn và điều trị phù hợp.
                        </div>
                    </div>

                    <!-- Health Tips Section -->
                    <div class="health-tips">
                        <h4 class="text-center fw-bold mb-4">
                            Lời khuyên cho sức khỏe tim mạch
                        </h4>
                        <div class="row g-4">
                            <div class="col-md-4">
                                <div class="tip-card">
                                    <div
                                        class="tip-icon bg-primary bg-opacity-10"
                                    >
                                        <i
                                            class="fas fa-utensils text-primary fa-2x"
                                        ></i>
                                    </div>
                                    <h5 class="fw-bold">Chế độ ăn lành mạnh</h5>
                                    <p class="mb-0">
                                        Ưu tiên trái cây, rau, ngũ cốc nguyên
                                        hạt, đạm nạc và chất béo lành mạnh. Hạn
                                        chế muối, đường và chất béo bão hòa.
                                    </p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="tip-card">
                                    <div
                                        class="tip-icon bg-success bg-opacity-10"
                                    >
                                        <i
                                            class="fas fa-person-walking text-success fa-2x"
                                        ></i>
                                    </div>
                                    <h5 class="fw-bold">Hoạt động thể chất</h5>
                                    <p class="mb-0">
                                        Tập thể dục ít nhất 150 phút mỗi tuần.
                                        Vận động vừa phải như đi bộ, bơi lội
                                        hoặc đạp xe rất tốt cho tim.
                                    </p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="tip-card">
                                    <div
                                        class="tip-icon bg-warning bg-opacity-10"
                                    >
                                        <i
                                            class="fas fa-ban-smoking text-warning fa-2x"
                                        ></i>
                                    </div>
                                    <h5 class="fw-bold">
                                        Tránh thuốc lá và rượu
                                    </h5>
                                    <p class="mb-0">
                                        Không hút thuốc và hạn chế rượu bia. Hút
                                        thuốc là yếu tố nguy cơ chính của bệnh
                                        tim mạch.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <p class="text-center text-muted small mt-5">
                        © 2025 SmartClinic.AI - Hệ thống hỗ trợ chẩn đoán y tế
                        thông minh
                    </p>
                </div>
            </div>
        </main>

        <!-- Nhúng footer mới -->
        <!--#include file="../../..../static/utils/home/footer.html" -->

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // Kiểm tra phân quyền khi trang tải
                if (!window.AuthGuard.isAdmin()) {
                    window.location.href =
                        "/core/auth/login.html?redirect=" +
                        encodeURIComponent(window.location.pathname) +
                        "&unauthorized=true";
                    return;
                }

                const urlParams = new URLSearchParams(window.location.search);
                const prediction = urlParams.get("prediction");
                const message = urlParams.get("message");

                const resultMessage = document.getElementById("resultMessage");
                const recommendation =
                    document.getElementById("recommendation");
                const resultIconWrapper =
                    document.getElementById("resultIconWrapper");
                const resultIcon = document.getElementById("resultIcon");
                const recommendationIcon =
                    document.getElementById("recommendationIcon");
                const recommendationTitle = document.getElementById(
                    "recommendationTitle"
                );
                const recommendationText =
                    document.getElementById("recommendationText");

                if (message) {
                    resultMessage.innerText = decodeURIComponent(message);
                }

                if (prediction === "1") {
                    // Nguy cơ suy tim
                    recommendation.classList.remove("d-none");
                    recommendation.classList.add("negative");
                    resultIconWrapper.classList.add("danger");
                    resultIcon.classList.remove("text-primary");
                    resultIcon.classList.add("text-danger");

                    recommendationIcon.classList.add(
                        "fa-exclamation-circle",
                        "text-danger"
                    );
                    recommendationTitle.innerText = "Nguy cơ suy tim";
                    recommendationText.innerHTML = `Dựa trên thông tin bạn cung cấp, hệ thống phát hiện <strong>nguy cơ suy tim</strong>. Đây là tình trạng cần sự chú ý đặc biệt và bạn nên đến bệnh viện để kiểm tra và điều trị sớm.`;

                    document
                        .getElementById("negativeResults")
                        .classList.remove("d-none");
                } else if (prediction === "0") {
                    // Không có nguy cơ suy tim
                    recommendation.classList.remove("d-none");
                    recommendation.classList.add("positive");
                    resultIconWrapper.classList.add("success");
                    resultIcon.classList.remove("text-primary");
                    resultIcon.classList.add("text-success");
                    resultIcon.classList.remove("fa-heartbeat");
                    resultIcon.classList.add("fa-heart");

                    recommendationIcon.classList.add(
                        "fa-check-circle",
                        "text-success"
                    );
                    recommendationTitle.innerText = "Tình trạng tim khỏe mạnh";
                    recommendationText.innerHTML = `Dữ liệu hiện tại cho thấy bạn <strong>không có dấu hiệu suy tim</strong>. Hãy tiếp tục duy trì lối sống lành mạnh và kiểm tra sức khỏe định kỳ.`;

                    document
                        .getElementById("positiveResults")
                        .classList.remove("d-none");
                } else {
                    // Unknown
                    recommendation.classList.remove("d-none");
                    recommendation.classList.add("bg-light");
                    recommendationIcon.classList.add(
                        "fa-question-circle",
                        "text-secondary"
                    );
                    recommendationTitle.innerText = "Không xác định";
                    recommendationText.innerHTML = `Không thể xác định kết quả dự đoán. Vui lòng kiểm tra lại thông tin nhập vào hoặc liên hệ với đội ngũ hỗ trợ của chúng tôi.`;
                }
            });
        </script>
    </body>
</html>
